<!DOCTYPE html>
<html>
<head>
<title>Pebble App Settings</title>
<script>

$('#b-cancel').click(function() {
    document.location = 'pebblejs://close';
});

function saveOptions() {
    var options = {
        searchingFor: $('#searchingFor').val()
    }
    return options;
}

$('#b-submit').click(function() {
    var location = 'pebblejs://close#' + encodeURIComponent(JSON.stringify(saveOptions()));
    document.location = location;
});

function getURLVariable(name)  {
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)",
      regex = new RegExp(regexS),
      results = regex.exec(window.location.href);
  if (results == null) return "";
  else return results[1];
}

$(document).ready(function() {
  var priorSearch = getURLVariable('searchingFor');
  priorSearch = decodeURI(priorSearch);

  if (priorSearch) {
    $('#searchingFor').html(priorSearch);
  }
}

</script>
</head>
<body>
<p>Pebble settings</p>

<label for="searchingFor">Whatcha wanna find?</label>
<textarea cols="40" rows="8" name="searchingFor" id="searchingFor"></textarea>
<button type="submit" id="b-cancel">Cancel</button>
<button type="submit" id="b-submit">Submit</button>

</body>
</html>
